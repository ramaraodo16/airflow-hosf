[2022-08-24 00:04:07,103] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: nse_daily_data_load.Stg_tgt_merge scheduled__2022-08-22T13:37:00+00:00 [queued]>
[2022-08-24 00:04:07,145] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: nse_daily_data_load.Stg_tgt_merge scheduled__2022-08-22T13:37:00+00:00 [queued]>
[2022-08-24 00:04:07,167] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-08-24 00:04:07,168] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-08-24 00:04:07,168] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-08-24 00:04:07,265] {taskinstance.py:1377} INFO - Executing <Task(SnowflakeOperator): Stg_tgt_merge> on 2022-08-22 13:37:00+00:00
[2022-08-24 00:04:07,271] {standard_task_runner.py:52} INFO - Started process 14970 to run task
[2022-08-24 00:04:07,285] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'nse_daily_data_load', 'Stg_tgt_merge', 'scheduled__2022-08-22T13:37:00+00:00', '--job-id', '377', '--raw', '--subdir', 'DAGS_FOLDER/nse_daily_load_stg.py', '--cfg-path', '/tmp/tmpsrjb5vix', '--error-file', '/tmp/tmpeh9essyq']
[2022-08-24 00:04:07,286] {standard_task_runner.py:80} INFO - Job 377: Subtask Stg_tgt_merge
[2022-08-24 00:04:07,385] {task_command.py:369} INFO - Running <TaskInstance: nse_daily_data_load.Stg_tgt_merge scheduled__2022-08-22T13:37:00+00:00 [running]> on host osboxes
[2022-08-24 00:04:07,575] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Airflow
AIRFLOW_CTX_DAG_ID=nse_daily_data_load
AIRFLOW_CTX_TASK_ID=Stg_tgt_merge
AIRFLOW_CTX_EXECUTION_DATE=2022-08-22T13:37:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-08-22T13:37:00+00:00
[2022-08-24 00:04:07,576] {snowflake.py:118} INFO - Executing:  MERGE into EDW_DEV.EDW.NSE_STOCK_DAILY_DATA_F f1
USING EDW_DEV.EDW.NSE_STOCK_DAILY_DATA_STream stg1
on f1.SYMBOL = stg1.SYMBOL and f1.TIMESTAMP = stg1.TIMESTAMP 
when not matched and stg1.METADATA$ACTION ='INSERT' and stg1.METADATA$ISUPDATE = FALSE 
then
insert (f1.SYMBOL,f1.SERIES,f1.OPEN,f1.HIGH,f1.LOW,f1.CLOSE,f1.LAST,f1.PREVCLOSE,f1.TOTTRDQTY,f1.TOTTRDVAL,f1.TIMESTAMP,f1.TOTALTRADES,f1.ISIN)  
values (stg1.SYMBOL,stg1.SERIES,stg1.OPEN,stg1.HIGH,stg1.LOW,stg1.CLOSE,stg1.LAST,stg1.PREVCLOSE,stg1.TOTTRDQTY,stg1.TOTTRDVAL,stg1.TIMESTAMP,stg1.TOTALTRADES,stg1.ISIN);
[2022-08-24 00:04:07,591] {base.py:68} INFO - Using connection ID 'snowflake_conn_id' for task execution.
[2022-08-24 00:04:07,601] {connection.py:257} INFO - Snowflake Connector for Python Version: 2.7.8, Python Version: 3.8.10, Platform: Linux-5.4.0-74-generic-x86_64-with-glibc2.29
[2022-08-24 00:04:07,602] {connection.py:876} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2022-08-24 00:04:07,602] {connection.py:894} INFO - Setting use_openssl_only mode to False
[2022-08-24 00:04:20,968] {cursor.py:710} INFO - query: [ALTER SESSION SET autocommit=True]
[2022-08-24 00:04:21,155] {cursor.py:734} INFO - query execution done
[2022-08-24 00:04:21,155] {snowflake.py:328} INFO - Running statement: MERGE into EDW_DEV.EDW.NSE_STOCK_DAILY_DATA_F f1
USING EDW_DEV.EDW.NSE_STOCK_DAILY_DATA_STream stg1
on f1.SYMBOL = stg1.SYMBOL and f1.TIMESTAMP = stg1.TIMESTAMP 
when not matched and stg1.METADATA$ACTION ='INSERT' and stg1.METADATA$ISUPDATE = FALSE 
then
insert (f1.SYMBOL,f1.SERIES,f1.OPEN,f1.HIGH,f1.LOW,f1.CLOSE,f1.LAST,f1.PREVCLOSE,f1.TOTTRDQTY,f1.TOTTRDVAL,f1.TIMESTAMP,f1.TOTALTRADES,f1.ISIN)  
values (stg1.SYMBOL,stg1.SERIES,stg1.OPEN,stg1.HIGH,stg1.LOW,stg1.CLOSE,stg1.LAST,stg1.PREVCLOSE,stg1.TOTTRDQTY,stg1.TOTTRDVAL,stg1.TIMESTAMP,stg1.TOTALTRADES,stg1.ISIN);, parameters: None
[2022-08-24 00:04:21,156] {cursor.py:710} INFO - query: [MERGE into EDW_DEV.EDW.NSE_STOCK_DAILY_DATA_F f1 USING EDW_DEV.EDW.NSE_STOCK_DAI...]
[2022-08-24 00:04:22,917] {cursor.py:734} INFO - query execution done
[2022-08-24 00:04:22,918] {snowflake.py:338} INFO - Statement execution info - {'number of rows inserted': 2228}
[2022-08-24 00:04:22,919] {snowflake.py:342} INFO - Rows affected: 2228
[2022-08-24 00:04:22,959] {snowflake.py:343} INFO - Snowflake query id: 01a67e74-0501-c2fc-006e-0a830004e012
[2022-08-24 00:04:22,961] {connection.py:507} INFO - closed
[2022-08-24 00:04:23,160] {connection.py:510} INFO - No async queries seem to be running, deleting session
[2022-08-24 00:04:23,687] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=nse_daily_data_load, task_id=Stg_tgt_merge, execution_date=20220822T133700, start_date=20220824T040407, end_date=20220824T040423
[2022-08-24 00:04:24,158] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-08-24 00:04:24,585] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
